dashboard:
  title: Sign-in Attempts [1Password]
  description: ""
  panels:
    - # Title likely derived from the saved search
      title: "1Password Sign-in Attempts Search" 
      type: search
      grid: { x: 0, y: 0, w: 31, h: 15 }
      saved_search_id: 1password-signin-attempts
    - title: Audit sign-in attempts Source Locations [1Password]
      type: map
      grid: { x: 31, y: 0, w: 17, h: 15 }
      layers:
        - type: vector_tile # Base map layer
          label: "Default Base Map"
        - type: geojson_vector
          label: "Source Locations"
          index_pattern: logs-*
          query: "data_stream.dataset:1password.signin_attempts"
          geo_field: source.geo.location
          style:
            type: circle
            size: 6
            color: "#54B399"
          tooltip_fields: []
    - title: Sign-in Attempts unsuccessful [1Password]
      type: lens
      visualization: metric
      grid: { x: 0, y: 15, w: 11, h: 9 }
      index_pattern: logs-* # Multiple index patterns referenced, using the first one
      # Panel-specific filters
      filters:
        - field: event.action
          type: phrases
          value: ["success", "firewall_reported_success"]
          negate: true
        - field: data_stream.dataset
          type: phrase
          value: "1password.signin_attempts"
          negate: false
      metrics:
        - type: count
          label: "Failed Signin Attempts"
      # Custom color palette needs representation
      palette:
        type: custom
        stops:
          - { color: "#209280", stop: null } # Base color
          - { color: "#d6bf57", stop: 10 }
          - { color: "#cc5642", stop: 30 }
    - title: Sign-in Attempts over time [1Password]
      type: lens
      visualization: line
      grid: { x: 11, y: 15, w: 20, h: 9 }
      index_pattern: logs-*
      query: "data_stream.dataset:1password.signin_attempts"
      dimensions:
        - field: "@timestamp"
          type: date_histogram
          label: "@timestamp"
          interval: auto
      metrics:
        - type: count
          label: Count
    - title: Sign-in Attempts categories over time [1Password]
      type: lens
      visualization: line
      grid: { x: 31, y: 15, w: 17, h: 9 }
      index_pattern: logs-*
      query: "data_stream.dataset:1password.signin_attempts"
      dimensions:
        - field: "@timestamp"
          type: date_histogram
          label: "@timestamp"
          interval: auto
        # Split dimension
        - field: event.action
          type: terms
          label: "event.action: Descending" # Original label
          size: 10
          order_by_metric: Count
          order_direction: desc
      metrics:
        - type: count
          label: Count
    - title: Sign-in Attempts hot users [1Password]
      type: lens
      visualization: table
      grid: { x: 0, y: 24, w: 48, h: 9 }
      index_pattern: logs-*
      # No specific query, likely relies on global dashboard filters
      query: "" 
      columns:
        - field: user.id
          type: terms
          label: Target User UUID
          size: 10
          order_by_metric: "Count of records"
          order_direction: desc
        - field: user.full_name
          type: terms
          label: Name
          size: 10
          order_by_metric: "Count of records"
          order_direction: desc
        - field: user.email
          type: terms
          label: Email
          size: 10
          order_by_metric: "Count of records"
          order_direction: desc
        - type: count
          label: "Count of records"