{
  "title": "Events by Status and Level (Nested Legend)",
  "visualizationType": "lnsPie",
  "references": [
    {
      "type": "index-pattern",
      "id": "{\"index\":\"logs-*\",\"timeFieldName\":\"@timestamp\"}",
      "name": "indexpattern-datasource-layer-layer_0"
    }
  ],
  "state": {
    "datasourceStates": {
      "textBased": {
        "layers": {
          "layer_0": {
            "index": "{\"index\":\"logs-*\",\"timeFieldName\":\"@timestamp\"}",
            "query": {
              "esql": "FROM logs-* | STATS count = COUNT() BY log.level, host.name | SORT count DESC | LIMIT 20"
            },
            "columns": [
              {
                "columnId": "metric_formula_accessor_breakdown_0",
                "fieldName": "log.level"
              },
              {
                "columnId": "metric_formula_accessor_breakdown_1",
                "fieldName": "host.name"
              },
              {
                "columnId": "metric_formula_accessor",
                "fieldName": "count"
              }
            ],
            "allColumns": [
              {
                "columnId": "metric_formula_accessor_breakdown_0",
                "fieldName": "log.level"
              },
              {
                "columnId": "metric_formula_accessor_breakdown_1",
                "fieldName": "host.name"
              },
              {
                "columnId": "metric_formula_accessor",
                "fieldName": "count"
              }
            ]
          }
        }
      }
    },
    "internalReferences": [],
    "filters": [],
    "query": {
      "language": "kuery",
      "query": ""
    },
    "visualization": {
      "shape": "pie",
      "layers": [
        {
          "layerId": "layer_0",
          "layerType": "data",
          "metrics": [
            "metric_formula_accessor"
          ],
          "allowMultipleMetrics": false,
          "numberDisplay": "percent",
          "categoryDisplay": "default",
          "legendDisplay": "show",
          "legendPosition": "right",
          "primaryGroups": [
            "metric_formula_accessor_breakdown_0",
            "metric_formula_accessor_breakdown_1"
          ]
        }
      ]
    },
    "adHocDataViews": {
      "{\"index\":\"logs-*\",\"timeFieldName\":\"@timestamp\"}": {}
    }
  }
}